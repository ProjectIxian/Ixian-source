<!DOCTYPE html>
<html>
    <head lang="en">
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>IXIAN Wallet</title>
        <link rel="stylesheet" type="text/css" href="https://resources.ixian.io/css/normalize.css">
        <link rel="stylesheet" type="text/css" href="https://resources.ixian.io/css/bootstrap37.css">
        <link rel="stylesheet" type="text/css" href="https://resources.ixian.io/css/style.css">
        
        <script src="https://resources.ixian.io/js/jquery.min.js"></script>
        <script src="https://resources.ixian.io/js/bootstrap.min.js"></script>
		<script src="https://resources.ixian.io/js/qrcode.min.js"></script>
        <script src="https://resources.ixian.io/js/instascan.min.js"></script>

        <style>
            .payment.sent .psign div {
                background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyhpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTExIDc5LjE1ODMyNSwgMjAxNS8wOS8xMC0wMToxMDoyMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTUgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6M0REMEI2RURCMTE4MTFFN0FBNTBGMDVGRUMxQUM3MjciIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6M0REMEI2RUVCMTE4MTFFN0FBNTBGMDVGRUMxQUM3MjciPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpCNzY0Qzk5NkIxMTExMUU3QUE1MEYwNUZFQzFBQzcyNyIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDozREQwQjZFQ0IxMTgxMUU3QUE1MEYwNUZFQzFBQzcyNyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PmplCeoAAAPfSURBVHja7JpLSFVRFIaPPbG82kCIqMwIsaSGRZQK6rhJUBpB+Rg260Xa46aVmEWOGmZGSTpp0lhLzSBoVphikZgWBEJmShl5+1YuJ00857jPPbvu2fCzJufs9f/7udbeOy2RSDipVNIiwZHgSHBqCx4qqAlVQP7AHU/fL3NSrKSc4GgOmy7M8Q2YMlAItoM8sBZkgUkwDYbBIHgGupiXn/4pwYhciSkH1SqyS8UMqrhpRE3yXZaKz9PvCrVxhkAr6OC7n9YKRkAa5gy4CjqVdA+k5zzUIetKsTZWBbgAblBHwirBED2KuQ/aQAMERwzUmYu5BCrBMep8YIVgiDVhDoIqSPUHMEX2aUM+ov5zoQmGyGrMLbBehiBkvga4+GViJMr4DE7i60dS92EIpGNawCw4FKRYjaik/sPqrwX/a5Lawzi8jfkOkVPJ3kvxfROTju8TSelhnbPZ4HRI8YPsBNnwuB54D+tqLCvn7qCH8SI8YpiX4IqX1duTYN1nf4GiIFZjn6u3BDTL3e7TXod0rWwPNojVhey5ble1xnuY1lyFmQLbcDRmSzIAr02YdyAGr1mTPSyxcadNYrWXxzSMLTc9pKs1NraxtCo/M4I1xcsHvZYKFl75ytNID5dpnjpno1rl1aU8jQjeD/odu0uvppVGBBeAAcsFvwY7TQneCt5bLngU5JgSvHD+ZHORGCG22EcrXFaW6Tdu/raxPo657PLzpxnj8RK/6aPmzEYE/6nMp+h7oMflt1+WmExMmRI8qcPas2B6bAQzkoQh7WrauZ3DQjjX8jnsamF1K3hAtyabyw7wxpRgyTkLLRdcBPpMCX4CSvQAwLqivEpBtxHBrM7jmLduQreQivAahudHk+mh6xQshOI6dfUiuANUMHy2WDacJZysUH7mBOvxiZxWXrSsd4VT3M3xjtceltIsw4dW3WtJ7wqPKuXlGBesR6GVoA1nGSGLFf93nfkLPNcHE76uWnDWrKnYEVP3tj62oYeSEuL/rJd/fV21qJMJ0BhSB4vfCa9ifQvWUicBO63dmKyARPyAa5oo1Pmpw7dgeaOxIBq0Bz2ntf52sA6cV/+ei6kXADKnD8iCBpEXAYjdo3n1Yz/D2LhgJXVcox25pW8wcUOh1yiyz8r7xhrqbFtqnaZf8cgUkTcYcR1+QrDPy0qu60GRbn9yNVsPmkydiQf1TmuVkq3UxFyyGDk3fuXMny5OIWBGny3EdIvbpUlAqSby0ljtbiOoUAX/JX6ziihWUTkqUsTOOPPnUKPaGNIo3Yj8EBSf6K2ljx4MVUD0XjoSHM3hSHAk+H8qvwUYAAz9qXUwEZq8AAAAAElFTkSuQmCC);
                width: 60px;
                height: 60px;
            }

            .payment.received .psign div {
                background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyhpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTExIDc5LjE1ODMyNSwgMjAxNS8wOS8xMC0wMToxMDoyMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTUgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6Qjc2NEM5OTRCMTExMTFFN0FBNTBGMDVGRUMxQUM3MjciIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6Qjc2NEM5OTVCMTExMTFFN0FBNTBGMDVGRUMxQUM3MjciPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpCNzY0Qzk5MkIxMTExMUU3QUE1MEYwNUZFQzFBQzcyNyIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpCNzY0Qzk5M0IxMTExMUU3QUE1MEYwNUZFQzFBQzcyNyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PvZNso4AAAQFSURBVHja7FpNSFVBFH6WRmWZ4aqIstCwaBEE/Zlh1raCVoqY9bQ2raIyDEpSyNSiVZsofyLSXYu25iL7XQQtQs0iXxK1Ecrns6DI13fsk0rQ7lzPvXfKO/Axgu/NOd85M3N+3qQkk8nIbBpzIrNshIRDwv/ZSJ3pArn1mwIl8Kr6WejhkPBvI2W2xeFULxfH+V6BqQgoANYBOcAiIB0YBRLAa6AX6Aa6cCbf/VMeBsl5mIqBCmCNkCCZXpJLgNQoPpdO8jk0RgGN8wZoBtrxua/WEgYBuQ+qgPNAB3BDiELppMEaKSQeBUqAGqARa4xZRRiKlmFqpWfqoOCgwporMZ0l+SjWbLOCMBRrxLSXSj324B7YQmPexfpVgRGGIkswXQCWAkehTMLDy0/O+jXgI3AGsoZ9jcMkWw/EgVIvyTKbkvVLKa+e8v3zMAReFeFQpNrvOArZYugMyD7mi4chsAFTlmytgHIHkZvFu8NbwryN9wNHTMKN8vYWuZXAPuhz0LMtzRj5Hcj34jZ2sdO2YnoEzDUxvomHJSQ020CWnn7CuF+lvqVhzTRJKAibhuhTy3RWtXgoYW77VqEpkA0UMpmYUWEv+kBWB3P3m5pbOsrtozGEcLmil5upn86WhgWXywTct7TElUosl3qqeLiIdaqVnQJWUl3UU4XwDuCB5Y2MbpaVKoTXAz2WE+5lE0GFsFwyMcsJDwCrtQhLZTJsOeFh6qkSh6UyibsIPdlT/G8jkMlYPNWImewq6DeCW3qxFuE4FjMlXThNrM2kMWqm+X7b3xKTSaEzg7WyCuGJ7WJCuHUahQtJdpfilhbvjmidYccXQoBDGn6DWoR7GJpsHhuAF1qEH0oNbDnhnU5TXyeEx9M2NtqtG9RrN3BPhTBu5/eY+mlFW737Enp+0CwPjUown4dR6eqU8HiRje2TraDgJ+C50nZexeK/w+l3TJp40jvKw9aJWnR+5Qe7fujUoO1hGU3AIQjZbgnZbZgOA0b9aceE2QCQPnCL07zVQ7Iiv0XSV9PGhPFPLfzlQc5ycRBdEPbH5czGIP+06feNYyuFDAGXAnKwHK0hN2RdEeY4CSyAta/Q4r54FriMPxcCp9yu44owrPsF03FAGuDtLM+8PrO3gfnACcj/7HYtjRcAFzEdAMqgyFMPyG7GdAu443YbqxKmUuXMdqQGrnX6C4WDpOKchEKgAmu2ahhQ+xWPnK26yJ+veMYM15C2cCUzKHnU0mTdK55JSqdFfr3TWgt0ssTsk+Mf+flOK85zL2835FeNPJage/iZ62I0fO6b9hHx9OkhSC0jiXySyiXJiR5UggT7aJROp1VPkJdWoClm+Hw4JOzjGQ49HBIOCYeEtccPAQYA9UWG23xSF+0AAAAASUVORK5CYII=);
                width: 60px;
                height: 60px;
            }
        </style>
    </head>
	
	<body>
        <div id="templates" style="display: none;">
            <div class="payment">
                <div class="row">
                    <div class="col-xs-2 psign"><div></div></div>
                    <div class="col-xs-6 pdesc">payment sent</div>
                    <div class="col-xs-4 pamount">-145</div>
                </div>
            </div>
        </div>

		<div id="wrap" class="container-fluid">
		    <nav class="navbar navbar-default navbar-fixed-top">
                <div class="row">
                    <div class="col-xs-10"><img src="https://resources.ixian.io/img/logofull.png" /></div> 
                    <div class="col-xs-2 navbar-version" id="version"></div>
                </div>
		    </nav>
            
            
            <div class="tab-content">

                <div id="home" class="tab-pane fade in active">

                    <div id="status_balance">
                        <p class="text-center top">Available Balance</p>
                        <p class="text-center"><span class="status_dbalance" id="activity_balance_number">0</span> <i>IXI</i></p>

                    </div>

                    <div class="recent_activity">
                        RECENT ACTIVITY
                    </div>

                    <div id="sync_bar" class="sync_bar">
                        <p class="text-center" style="padding-top:8px">The blockchain is not fully synchronized</p>
                    </div>

                    <div id="payments">

                        
                    </div>
				
                </div>
                
                
                
                
                <div id="receive" class="tab-pane fade">
                           
                    <div class="screen_headerbar">
                        <p class="text-center" style="padding-top:8px">Receive Funds</p>
                    </div>
                    
                    <div id="qr_container">
                        <p class="text-center top">scan the QR code to send funds</p>
						<div id="qrcode" class="middle"></div>
                        
                        <p class="text-center bottom">CURRENT ADDRESS</p>

                    </div>
                    
                    <div class="receive_address" id="receive_own_address">
                        0
                    </div>
                    
                    <div class="generate_address">
                        Generate new address
                    </div>
                    
                </div>
                
                
                
                <div id="send" class="tab-pane fade">
                    <div class="screen_headerbar">
                        <p class="text-center" style="padding-top:8px">Send Funds</p>
                    </div>
                    
                    <div class="send_address">
                        enter address or scan QR code
                    </div>
                    
					<form id="sendForm">
                        
                    <div class="address_edit">
						<input type="text" id="address" placeholder="" class="input-sm form-control address_input">
                        <img class="camerabtn" onclick="javascript:readQR()" src="https://resources.ixian.io/img/camera.png" style="display: inline-block" />                       
                    </div>
                        
                    <div class="send_amount">
                        enter amount
                    </div>
					
                    <div class="amount_edit">
						<input type="text" id="amount" placeholder="" class="input-sm form-control">
                    </div>
                        
                        
                    <div id="send_balance">
                        <p class="text-center top">Available Balance</p>
                        <p class="text-center"><span class="status_dbalance" id="send_balance_number">0</span> <i>IXI</i></p>

                    </div>
                        
                    <div class= "send_button_wrap">
                        <input type="submit" class="btn sendbtn" value="Send">
    
                    </div>
                        
					</form>
                    
                </div>
                
            </div>
            

            
		</div>
		<div id="footer">
		  <div class="col-xs-12 navbar-inverse navbar-fixed-bottom">
		  <div class="row" id="bottomNav">
		    <div id="tab1" class="col-xs-4 text-center"><a data-toggle="tab" href="#receive"><img src="https://resources.ixian.io/img/receive.png"/><br>RECEIVE</a></div>
		    <div id="tab2" class="col-xs-4 text-center active"><a data-toggle="tab" href="#home"><img src="https://resources.ixian.io/img/activity.png"/><br>ACTIVITY</a></div>
		    <div id="tab3" class="col-xs-4 text-center"><a data-toggle="tab" href="#send"><img src="https://resources.ixian.io/img/send.png"/><br>SEND</a></div>
		  </div>
		  </div>
		</div>
		
		
		
		
		<script type="text/javascript">
		var qrcode = new QRCode(document.getElementById("qrcode"), {
			width : 300,
			height : 300
		});
            
        var balance = 0;
            
        function getMyWallet() {
            
            var dltAPI = "#IXIAN#NODE#URL#";
			$.getJSON(dltAPI+"mywallet", { } )
                .done(function (data) {
                    data = data["result"];
                    var sync_status = data[2];
                    balance = data[1];
                    var address = data[0];

                    // Assign relevant wallet information
                    document.getElementById("activity_balance_number").innerHTML = balance;
                    document.getElementById("send_balance_number").innerHTML = balance;
                    document.getElementById("receive_own_address").innerHTML = address;

                if(sync_status == "sync")
                {
                    // Show the syncbar
    				document.getElementById("sync_bar").style.display = "block";
                }
                else
                {
				    // Hide the syncbar
				    document.getElementById("sync_bar").style.display = "none";
                }

				// Create the QR code
				qrcode.clear();
				qrcode.makeCode(address);
				

			});
        }

        function statusToString(status) {
            switch (status) {
                case 1:
                    return "Pending";
                case 2:
                    return "Final";
                case 3:
                    return "Error";
                default:
                    return "Unknown - " + status;
            }

        }

        function getActivity() {
            var dltAPI = "#IXIAN#NODE#URL#";
            $.getJSON(dltAPI + "activity", {})
                .done(function (data) {
                    document.getElementById("payments").innerHTML = "";
                    for(var i in data["result"])
                    {
                        var paymentsEl = document.getElementById("payments");
                        paymentsEl.innerHTML += document.getElementById("templates").getElementsByClassName("payment")[0].outerHTML;
                        var htmlEl = paymentsEl.lastElementChild;
                        htmlEl.getElementsByClassName("pdesc")[0].innerHTML = data["result"][i]["toList"];
                        var type = data["result"][i]["type"];
                        if (type == 100) {
                            htmlEl.className += " received";
                            htmlEl.getElementsByClassName("pamount")[0].innerHTML = data["result"][i]["value"];
                            htmlEl.getElementsByClassName("pdesc")[0].innerHTML = data["result"][i]["from"];
                        } else if (type == 101) {
                            htmlEl.className += " sent";
                            htmlEl.getElementsByClassName("pamount")[0].innerHTML = "-" + data["result"][i]["value"];
                        } else if (type == 200) {
                            htmlEl.className += " received";
                            htmlEl.getElementsByClassName("pamount")[0].innerHTML = data["result"][i]["value"];
                            htmlEl.getElementsByClassName("pdesc")[0].innerHTML = data["result"][i]["from"];
                            htmlEl.getElementsByClassName("pdesc")[0].innerHTML += "<br/>Mining Reward";
                        } else if (type == 201) {
                            htmlEl.className += " received";
                            htmlEl.getElementsByClassName("pamount")[0].innerHTML = data["result"][i]["value"];
                            htmlEl.getElementsByClassName("pdesc")[0].innerHTML += "<br/>Staking Reward";
                        }
                        var date = new Date(data["result"][i]["timestamp"] * 1000);
                        htmlEl.getElementsByClassName("psign")[0].innerHTML += date.getDay() + "." + date.getMonth() + "." + date.getFullYear() + " " + date.getHours() + ":" + date.getMinutes() + ":" + date.getSeconds();
                        var status = statusToString(data["result"][i]["status"]);
                        htmlEl.getElementsByClassName("pdesc")[0].innerHTML += " - " + status;
                    }
                });
        }

        function getNodeStatus() {
            var dltAPI = "#IXIAN#NODE#URL#";
            $.getJSON(dltAPI + "status", {})
                .done(function (data) {

                });
        }
		
            
        function sendTransaction() {
            var address = document.getElementById("address").value;
            var amount = document.getElementById("amount").value;
            
			console.log("Amount " + amount);
            if(amount < 1) //  || amount > balance)
            {
                alert("Incorrect amount. Make sure you have enough IXI available.");
                return;
            }
            
//            console.log("Sending " + amount + " to " + address);
            
            var dltAPI = "#IXIAN#NODE#URL#"+"addtransaction?to="+address+"_"+amount;						
			$.getJSON(dltAPI, {format : "json"})
				.done(function(data) {
					getMyWallet();
				});
			
        }
        
        
        function readQR() {
            console.log( "Starting QR code reader");
            
            let scanner = new Instascan.Scanner({ });
              scanner.addListener('scan', function (content) {
                    console.log("QRscanner: " + content);
                    document.getElementById("address").innerHTML = content;
              });
              Instascan.Camera.getCameras().then(function (cameras) {
                if (cameras.length > 0) {
                    scanner.start(cameras[0]);
                } else {
                    console.error('No cameras found.');
                    alert("No camera found. Please type the address to send funds to.");
                }
              }).catch(function (e) {
                console.error(e);
              });
            
        }
        
            
        // Function to toggle tab's active color    
        $('a[data-toggle="tab"]').on('shown.bs.tab', function (e) {
                // Not very elegant, but it works
                document.getElementById("tab1").className = "col-xs-4 text-center";
                document.getElementById("tab2").className = "col-xs-4 text-center";
                document.getElementById("tab3").className = "col-xs-4 text-center";
                e.target.parentElement.className = "col-xs-4 text-center active";                    
        })
            
        $(function() {
            console.log( "Wallet loaded" );
            
            getMyWallet();
            setInterval(getMyWallet, 5000);
            setInterval(getActivity, 5000);
        });
            
        $('#sendForm').submit(function() {
            sendTransaction();
            return false;
        });
            
		</script>
	</body>
</html>