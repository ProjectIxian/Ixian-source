<!DOCTYPE html>
<html>

<head lang="en">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <title>IXIAN</title>
    <link rel="stylesheet" type="text/css" href="css/normalize.css">
    <link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="css/spixiui.css">

    <link rel="stylesheet" type="text/css" href="libs/fontawesome/css/fontawesome.min.css">
    <link rel="stylesheet" type="text/css" href="libs/fontawesome/css/solid.min.css">

    
    <script src="js/jquery.min.js"></script>
    <script src="js/jquery.touchSwipe.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/qrcode.min.js"></script>
    <script src="js/spixi.js"></script>
    
</head>
<body onload="test()">
    <div id="wrap" class="container-fluid noselect">
        
        <!-- Toolbar Chat -->
        <div class="spixi-toolbar shadow" >
            <div class="spixi-toolbar-line"></div>
            <div class="row spixi-toolbar-row" style="padding-top: 0px;">
                <div id="backbtn" class="col-2 spixi-center" style="padding-top: 10px;">
                    <i class="fas fa-arrow-left"></i>
                </div>
                <div class="col-8">
                    <div class="spixi-toolbar-chat-name">Andrew</div>
                    <div class="spixi-toolbar-chat-status">last seen online</div>                    
                </div>
                <div class="col-2 spixi-center">
                    
                </div>     
            </div>
            
        </div>
        <div class="spixi-toolbar-holder"></div>
        <!-- End Toolbar -->   
        
        <div id="messages"></div>

        <div id="chatholder" class="chatholder"></div>
        <div id="chatbar">
            <div id="chat_attach">
                <i class="fa fa-wallet"></i>
            </div>
            <input type="text" id="chat_input" onkeyup="" placeholder="Type your message...">
            <div id="chat_send"></div>
        </div>
        <div id="chatattachbar">
            <div id="ca_send">Send IXI</div>
            <div id="ca_request">Request IXI</div>
        </div>
        
    </div>
    
    
<script type="text/javascript">
    
    document.getElementById("backbtn").onclick = function() {
        location.href = "ixian:back";
    } 
    
    function htmlEscape(str) {
        return str
            .replace(/&/g, '&amp;')
            .replace(/"/g, '&quot;')
            .replace(/'/g, '&#39;')
            .replace(/</g, '&lt;')
            .replace(/>/g, '&gt;')
            .replace(/\//g, '&#x2F;');
    }
    
    function test() {
                
            addMe("avatar1.png", "Hi!", "11:23 AM");
            setTimeout(function () { addMe("avatar.png", "How are you today?", "11:23 AM"); }, 1000);
            setTimeout(function () { addThem("avatar1.png", "Hey!", "11:24 AM"); }, 1300);
            setTimeout(function () { addThem("avatar.png", "Great, thanks for asking.", "11:24 AM"); }, 1600);
            setTimeout(function () { addThem("avatar1.png", "And how are you?", "11:24 AM"); }, 1900);
            setTimeout(function () { addMe("avatar1.png", "Great! Just got back from the moon.", "11:24 AM"); }, 2200);
            setTimeout(function () { addThem("avatar1.png", "Ohh??? What were you doing there?", "11:25 AM"); }, 2500);
            setTimeout(function () { addMe("avatar1.png", "Was building my own Luna Park...", "11:25 AM"); }, 3000);
            setTimeout(function () { addMe("avatar1.png", "html<div>injection</div>test", "11:25 AM"); }, 4000);
    //        setTimeout(function () { addPaymentRequest("1.200,5000");},1100);
       //     setTimeout(function () { addPaymentSent("1.200.200,50000000");},1500);

            //setTimeout(function() {sentModal.display.style = "block";}, 4500);
            //sentModal.style.display = "block";
            //    showContactRequest(true);
    }
    
    
    function addText(avatar, text, time, className) {

                var textEl = document.createElement('div');
                textEl.className = "text";
                textEl.innerHTML = htmlEscape(text);

                var timeEl = document.createElement('div');
                timeEl.className = "time";
                timeEl.innerHTML = htmlEscape(time);

                var avatarEl = document.createElement('img');
                avatarEl.className = "avatar";
                avatarEl.src = avatar;

                var bubbleEl = document.createElement('div');
                bubbleEl.className = className + "";
                bubbleEl.appendChild(textEl);
                bubbleEl.appendChild(timeEl);
                bubbleEl.appendChild(avatarEl);

                document.getElementById("messages").appendChild(bubbleEl);
                //window.scrollTo(0, document.body.scrollHeight);             
                bubbleEl.scrollIntoView(true);
    }

    function addMe(avatar, text, time) {                
                var textEl = document.createElement('div');
                textEl.className = "text";
                textEl.innerHTML = htmlEscape(text);

                var timeEl = document.createElement('div');
                timeEl.className = "time";
                timeEl.innerHTML = htmlEscape(time);

                var bubbleEl = document.createElement('div');
                bubbleEl.className = "spixi-bubble myself" + "";
                bubbleEl.appendChild(textEl);
                bubbleEl.appendChild(timeEl);

                document.getElementById("messages").appendChild(bubbleEl);
                //window.scrollTo(0, document.body.scrollHeight);             
                bubbleEl.scrollIntoView(true);
    }

    function addThem(avatar, text, time) {
        addText(avatar, text, time, "spixi-bubble");
    }    
    
    
</script>

</body>
</html>